# Вузли-валідатори (Validator Node)

Вузол Aptos — це об’єкт екосистеми Aptos, який відстежує стан блокчейна Aptos. Клієнти взаємодіють з блокчейном через вузли Aptos. Існує два типи вузлів:

+ Повний вузол (Full Node)
+ Валідатор 

Each Aptos node comprises several logical components:

+ REST service
+ Mempool
+ Consensus (disabled in FullNodes)
+ Execution
+ Virtual Machine
+ Storage
+ State synchronizer

Програмне забезпечення Aptos-core можна налаштувати на роботу як вузол перевірки або як повний вузол.

## Огляд

Коли транзакція передається в Aptos Blockchain, вузли-валідатори запускають розподілений протокол консенсусу, виконують транзакцію та зберігають транзакцію та результати виконання в блокчейні. Вузли-валідатори вирішують, які транзакції будуть додані в блокчейн і в якому порядку.

Блокчейн Aptos використовує протокол консенсусу **Byzantine Fault Tolerance** (BFT) для вузлів-валідаторів, щоб узгодити реєстр завершених транзакцій та результати їх виконання. Вузли перевірки обробляють ці транзакції та включають їх у свою локальну копію бази даних блокчейну. Це означає, що сучасні вузли перевірки завжди зберігають локально копію поточного стану блокчейну.

Вузли-валідатори спілкуються безпосередньо з іншими вузлами-валідаторами через приватну мережу. Повні вузли — це зовнішній ресурс перевірки та/або поширення остаточної історії транзакцій. Вони отримують транзакції від однорангових партнерів і можуть повторно виконувати їх локально (так само, як валідатор виконує транзакції). Повні вузли зберігають результати повторно виконаних транзакцій у локальне сховище. При цьому вони можуть оскаржити будь-яку нечесну гру валідаторів і надати докази, якщо є спроба переписати або змінити історію блокчейну. Це допомагає пом’якшити корупцію та/або змову валідатора.

> Консенсусний протокол AptosBFT забезпечує відмовостійкість до однієї третини шкідливих вузлів перевірки.

## Компоненти вузла перевірки

![](https://aptos.dev/assets/images/validator-444a20a96f90a1d3e9c1d7b84b402f68.svg)

### Mempool

Mempool — це компонент у кожному вузлі, який містить у пам’яті буфер транзакцій, які були передані в блокчейн, але ще не узгоджені чи виконані. Цей буфер реплікується між вузлами перевірки та повними вузлами.

Служба JSON-RPC FullNode надсилає транзакції до мемпулу вузла перевірки. Mempool виконує різноманітні перевірки транзакцій, щоб забезпечити дійсність транзакцій і захистити від атак DOS. Коли нова транзакція проходить первинну перевірку та додається до mempool, вона потім поширюється на мемпули інших вузлів перевірки в мережі.

Коли вузол валідатора тимчасово стає лідером у протоколі консенсусу, консенсус витягує транзакції з mempool і пропонує новий блок транзакцій. Цей блок транслюється іншим валідаторам і містить загальне впорядкування всіх транзакцій у блоці. Потім кожен валідатор виконує блокування та голосує за те, чи приймати нову пропозицію блокування чи ні.

### Consensus

Consensus — це компонент, який відповідає за упорядкування блоків транзакцій та узгодження результатів виконання шляхом участі в протоколі консенсусу з іншими вузлами валідатора в мережі.

### Execution

Execution — це компонент, який координує виконання блоку транзакцій і підтримує перехідний стан. Голосування консенсусу щодо цього перехідного стану. Execution підтримує подання результатів виконання в пам’яті, поки консенсус не передає блок у розподілену базу даних. Execution використовує віртуальну машину для виконання транзакцій. Execution діє як шар склеювання між входами системи (представленими транзакціями), сховищем (забезпечує рівень збереження) і віртуальною машиною (для виконання).

### Virtual machine (VM)

Віртуальна машина (VM) використовується для запуску програми Move в кожній транзакції та визначення результатів виконання. Мемпул вузла використовує віртуальну машину для виконання перевірок транзакцій, тоді як виконання використовує віртуальну машину для виконання транзакцій.

### Storage

Компонент зберігання використовується для збереження узгоджених блоків транзакцій і результатів їх виконання в локальній базі даних.

### State synchronizer

Вузли використовують свій компонент синхронізатора стану, щоб «догнати» останній стан блокчейну та залишатися в курсі.